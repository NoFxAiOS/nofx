name: Deploy to Hugging Face

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Prepare deployment files
        run: |
          mkdir -p deploy_temp
          cp app.py deploy_temp/
          cp requirements.txt deploy_temp/
          cp Dockerfile deploy_temp/
          cp README.md deploy_temp/
          cp supabase_config.py deploy_temp/
          echo "✅ 部署文件准备完成"

      - name: Deploy to Hugging Face
        uses: peaceiris/actions-gh-pages@v3
        with:
          personal_token: ${{ secrets.HF_TOKEN }}
          external_repository: lcy1313/nofxbishenjigir
          publish_branch: main
          keep_files: false
          publish_dir: ./deploy_temp
