# AI è¾“å…¥æ•°æ®å®Œæ•´ç»“æ„è¯´æ˜

## ğŸ“‹ ç›®å½•
1. [æ€»ä½“æ¶æ„](#æ€»ä½“æ¶æ„)
2. [ä¸‰å±‚æ•°æ®åˆ†ç±»](#ä¸‰å±‚æ•°æ®åˆ†ç±»)
3. [è¡Œæƒ…æ•°æ®è¯¦è§£](#è¡Œæƒ…æ•°æ®è¯¦è§£)
4. [è´¦æˆ·å’ŒæŒä»“æ•°æ®](#è´¦æˆ·å’ŒæŒä»“æ•°æ®)
5. [æ€§èƒ½è¯„ä¼°æ•°æ®](#æ€§èƒ½è¯„ä¼°æ•°æ®)
6. [ç³»ç»ŸPromptè¯´æ˜](#ç³»ç»Ÿpromptè¯´æ˜)
7. [å®Œæ•´æ•°æ®æµç¤ºä¾‹](#å®Œæ•´æ•°æ®æµç¤ºä¾‹)

---

## æ€»ä½“æ¶æ„

ç³»ç»Ÿæ¯æ¬¡è°ƒç”¨AIéƒ½éµå¾ªè¿™ä¸ªæµç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨ decision.GetFullDecisionWithCustomPrompt()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ è·å–ä¸Šä¸‹æ–‡æ•°æ®  â”‚ (buildContext)
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æ„å»ºä¸¤ä¸ªPrompt     â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ 1. System Prompt   â”‚ (è§„åˆ™å›ºå®š)
        â”‚ 2. User Prompt     â”‚ (æ•°æ®åŠ¨æ€)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ è°ƒç”¨AI API          â”‚
        â”‚ (ä½¿ç”¨messages API)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ AIè¿”å›å®Œæ•´å“åº”      â”‚
        â”‚ â€¢ æ€ç»´é“¾ CoT        â”‚
        â”‚ â€¢ JSONå†³ç­–åˆ—è¡¨      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ è§£æå’ŒéªŒè¯          â”‚
        â”‚ â€¢ æå– CoT          â”‚
        â”‚ â€¢ æå– JSON         â”‚
        â”‚ â€¢ éªŒè¯å†³ç­–          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ è¿”å› FullDecision   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰å±‚æ•°æ®åˆ†ç±»

### ç¬¬ä¸€å±‚ï¼šå®æ—¶è¡Œæƒ…æ•°æ® (Market Data)
ä»Binance WebSocketå®æ—¶è·å–ï¼ŒåŒ…å«æŠ€æœ¯æŒ‡æ ‡å’Œå¸‚åœºæ·±åº¦ã€‚

### ç¬¬äºŒå±‚ï¼šç´¯è®¡é™„åŠ æ•°æ® (Cumulative Context)
äº¤æ˜“è¿‡ç¨‹ä¸­ç´¯ç§¯çš„ä¸šåŠ¡æ•°æ®ï¼ŒåŒ…å«è´¦æˆ·ã€æŒä»“ã€è¡¨ç°æŒ‡æ ‡ã€‚

### ç¬¬ä¸‰å±‚ï¼šè§„åˆ™å’Œæç¤ºè¯ (System Prompt)
äº¤æ˜“ç­–ç•¥çš„ç¡¬è§„åˆ™å’ŒAIæŒ‡å¯¼åŸåˆ™ã€‚

---

## è¡Œæƒ…æ•°æ®è¯¦è§£

### æ•°æ®æ¥æº
```
Binance WebSocket (wss://fstream.binance.com/stream)
  â”œâ”€ 15åˆ†é’ŸKçº¿ (@kline_15m)
  â”œâ”€ 1å°æ—¶Kçº¿ (@kline_1h)
  â”œâ”€ æŒä»“é‡ (Open Interest API)
  â””â”€ èµ„é‡‘è´¹ç‡ (Funding Rate API)
```

### æ¯ä¸ªå¸ç§çš„å¸‚åœºæ•°æ®ç»“æ„ (`market.Data`)

```go
type Data struct {
    // åŸºç¡€ä¿¡æ¯
    Symbol            string       // äº¤æ˜“å¯¹ "BTCUSDT"
    
    // å½“å‰ä»·æ ¼å’Œä»·æ ¼å˜åŒ–
    CurrentPrice      float64      // å½“å‰ä»·æ ¼ 42300.75
    PriceChange1h     float64      // 1å°æ—¶å†…ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯” 0.45%
    PriceChange4h     float64      // 4å°æ—¶å†…ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯” 1.23%
    
    // å¿«é€ŸæŠ€æœ¯æŒ‡æ ‡ï¼ˆå³æ—¶è®¡ç®—ï¼‰
    CurrentEMA20      float64      // EMA20 42250.30
    CurrentMACD       float64      // MACDæŒ‡æ ‡ 12.50
    CurrentRSI7       float64      // RSI7æŒ‡æ ‡ 68.5
    
    // æŒä»“é‡æ•°æ®
    OpenInterest      *OIData      // æœ€æ–°æŒä»“é‡ å’Œ å¹³å‡æŒä»“é‡
    
    // èµ„é‡‘è´¹ç‡
    FundingRate       float64      // å½“å‰èµ„é‡‘è´¹ç‡ 0.00045
    
    // æ—¥å†…æ•°æ®åºåˆ—ï¼ˆåŸºäº15åˆ†é’ŸKçº¿ï¼‰
    IntradaySeries    *IntradayData
    
    // é•¿æœŸæ•°æ®ä¸Šä¸‹æ–‡ï¼ˆåŸºäº1å°æ—¶Kçº¿ï¼‰
    LongerTermContext *LongerTermData
}
```

### IntradayData - æ—¥å†…æ•°æ®ï¼ˆ15åˆ†é’Ÿç²’åº¦ï¼‰

```go
type IntradayData struct {
    MidPrices   []float64  // æœ€è¿‘Nä¸ª15åˆ†é’ŸKçº¿çš„ä¸­ç‚¹ä»·æ ¼
                           // ä¾‹: [42100, 42120, 42140, 42165]
    EMA20Values []float64  // å¯¹åº”æ¯æ ¹Kçº¿çš„EMA20å€¼åºåˆ—
                           // ä¾‹: [42200, 42210, 42230, 42250]
    MACDValues  []float64  // å¯¹åº”æ¯æ ¹Kçº¿çš„MACDå€¼åºåˆ—
                           // ä¾‹: [10.5, 11.2, 12.0, 12.5]
    RSI7Values  []float64  // å¯¹åº”æ¯æ ¹Kçº¿çš„RSI7å€¼åºåˆ—
                           // ä¾‹: [65, 66, 67, 68.5]
    RSI14Values []float64  // å¯¹åº”æ¯æ ¹Kçº¿çš„RSI14å€¼åºåˆ—
                           // ä¾‹: [60, 61, 62, 63]
}
```

### LongerTermData - é•¿æœŸæ•°æ®ï¼ˆ1å°æ—¶ç²’åº¦ï¼‰

```go
type LongerTermData struct {
    EMA20         float64   // 1håŸºç¡€ä¸Šçš„20æœŸEMA 42150.00
    EMA50         float64   // 1håŸºç¡€ä¸Šçš„50æœŸEMA 41800.00
    ATR3          float64   // 3å‘¨æœŸATR (1hä¸Šçš„æ³¢åŠ¨èŒƒå›´) 250.00
    ATR14         float64   // 14å‘¨æœŸATR 280.00
    CurrentVolume float64   // å½“å‰1hçš„æˆäº¤é‡ 5000.50
    AverageVolume float64   // å¹³å‡1hçš„æˆäº¤é‡ 4500.00
    MACDValues    []float64 // 1håŸºç¡€ä¸Šçš„MACDåºåˆ—
                            // ä¾‹: [8.0, 9.5, 11.0, 12.5]
    RSI14Values   []float64 // 1håŸºç¡€ä¸Šçš„RSI14åºåˆ—
                            // ä¾‹: [55, 58, 60, 63]
}
```

### å‘é€ç»™AIçš„å¸‚åœºæ•°æ®æ ¼å¼

ä½¿ç”¨ `market.Format(data)` è½¬æ¢ä¸ºæ–‡æœ¬ï¼š

```
current_price = 42300.7500, current_ema20 = 42250.300, current_macd = 12.500, current_rsi (7 period) = 68.500

In addition, here is the latest BTCUSDT open interest and funding rate for perps:

Open Interest: Latest: 1234567 Average: 1000000

Funding Rate: 4.50e-04

Intraday series (15â€‘minute intervals, oldest â†’ latest):

Mid prices: [42100, 42120, 42140, 42165]

EMA indicators (20â€‘period): [42200, 42210, 42230, 42250]

MACD indicators: [10.5, 11.2, 12.0, 12.5]

RSI indicators (7â€‘Period): [65, 66, 67, 68.5]

RSI indicators (14â€‘Period): [60, 61, 62, 63]

Longerâ€‘term context (1â€‘hour timeframe):

20â€‘Period EMA: 42150.300 vs. 50â€‘Period EMA: 41800.300

3â€‘Period ATR: 250.300 vs. 14â€‘Period ATR: 280.300

Current Volume: 5000.300 vs. Average Volume: 4500.300

MACD indicators: [8.0, 9.5, 11.0, 12.5]

RSI indicators (14â€‘Period): [55, 58, 60, 63]
```

### æ•°æ®è®¡ç®—è¯´æ˜

| å­—æ®µ | è®¡ç®—æ–¹å¼ | æ¥æºKçº¿ | æ›´æ–°é¢‘ç‡ |
|------|--------|--------|--------|
| **CurrentPrice** | æœ€æ–°Kçº¿Closeä»· | 15m | æ¯ç§’ |
| **PriceChange1h** | (Closeç° - Close 4æ ¹å‰) / Close 4æ ¹å‰ Ã— 100 | 15m | æ¯15åˆ†é’Ÿ |
| **PriceChange4h** | (Closeç° - Close 4æ ¹å‰) / Close 4æ ¹å‰ Ã— 100 | 1h | æ¯1å°æ—¶ |
| **CurrentEMA20** | è®¡ç®—æœ€æ–°20æ ¹15m Kçº¿çš„EMA | 15m | æ¯ç§’ |
| **CurrentMACD** | MACD(12,26,9) on 15m Close | 15m | æ¯ç§’ |
| **CurrentRSI7** | RSI7 on 15m Close | 15m | æ¯ç§’ |
| **IntradaySeries** | æœ€è¿‘å¤šæ ¹15m Kçº¿çš„æŒ‡æ ‡åºåˆ— | 15m | æ¯15åˆ†é’Ÿ |
| **LongerTermData** | åŸºäº1h Kçº¿è®¡ç®— | 1h | æ¯1å°æ—¶ |

---

## è´¦æˆ·å’ŒæŒä»“æ•°æ®

### è´¦æˆ·ä¿¡æ¯ (`AccountInfo`)

```go
type AccountInfo struct {
    TotalEquity      float64 // è´¦æˆ·å‡€å€¼ï¼ˆæ€»èµ„äº§ï¼‰
    AvailableBalance float64 // å¯ç”¨ä½™é¢ï¼ˆæœªè¢«å ç”¨çš„ä¿è¯é‡‘ï¼‰
    TotalPnL         float64 // æ€»ç›ˆäºé‡‘é¢ï¼ˆUSDTï¼‰
    TotalPnLPct      float64 // æ€»ç›ˆäºç™¾åˆ†æ¯”ï¼ˆ%ï¼‰
    MarginUsed       float64 // å·²ä½¿ç”¨çš„ä¿è¯é‡‘ï¼ˆUSDTï¼‰
    MarginUsedPct    float64 // ä¿è¯é‡‘ä½¿ç”¨ç‡ï¼ˆ%ï¼‰
    PositionCount    int     // å½“å‰æŒä»“ä¸ªæ•°
}
```

**ç¤ºä¾‹å€¼ï¼š**
```
{
    "total_equity": 10000.00,      // æ€»èµ„äº§10000 USDT
    "available_balance": 6000.00,  // å¯ç”¨6000 USDT
    "total_pnl": 500.00,           // èµšäº†500 USDT
    "total_pnl_pct": 5.0,          // æ”¶ç›Šç‡5%
    "margin_used": 4000.00,        // ç”¨äº†4000ä¿è¯é‡‘
    "margin_used_pct": 40.0,       // ä¿è¯é‡‘ä½¿ç”¨ç‡40%
    "position_count": 2            // æŒä»“2ä¸ªå¸ç§
}
```

### æŒä»“ä¿¡æ¯ (`PositionInfo`)

```go
type PositionInfo struct {
    Symbol           string  // äº¤æ˜“å¯¹ "BTCUSDT"
    Side             string  // "long" æˆ– "short"
    EntryPrice       float64 // å…¥åœºä»·æ ¼ 42000.00
    MarkPrice        float64 // å½“å‰æ ‡è®°ä»·æ ¼ 42300.00
    Quantity         float64 // æŒä»“æ•°é‡ 0.5 BTC
    Leverage         int     // æ æ†å€æ•° 5
    UnrealizedPnL    float64 // æœªå®ç°ç›ˆäºï¼ˆUSDTï¼‰300.00
    UnrealizedPnLPct float64 // æœªå®ç°ç›ˆäºç™¾åˆ†æ¯” 1.5%
    LiquidationPrice float64 // å¼ºåˆ¶å¹³ä»“ä»· 35700.00
    MarginUsed       float64 // æ­¤ä»“ä½å ç”¨ä¿è¯é‡‘ 2000.00
    UpdateTime       int64   // æŒä»“æ›´æ–°æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
}
```

**ç¤ºä¾‹å€¼ï¼š**
```
[
    {
        "symbol": "BTCUSDT",
        "side": "long",
        "entry_price": 42000.00,
        "mark_price": 42300.00,
        "quantity": 0.5,
        "leverage": 5,
        "unrealized_pnl": 300.00,
        "unrealized_pnl_pct": 1.5,
        "liquidation_price": 35700.00,
        "margin_used": 2000.00,
        "update_time": 1700000000000
    },
    {
        "symbol": "ETHUSDT",
        "side": "short",
        "entry_price": 2500.00,
        "mark_price": 2480.00,
        "quantity": 2.0,
        "leverage": 3,
        "unrealized_pnl": 40.00,
        "unrealized_pnl_pct": 0.8,
        "liquidation_price": 2820.00,
        "margin_used": 1600.00,
        "update_time": 1700000000000
    }
]
```

### å€™é€‰å¸ç§ä¿¡æ¯ (`CandidateCoin`)

```go
type CandidateCoin struct {
    Symbol  string   // äº¤æ˜“å¯¹ "BNBUSDT"
    Sources []string // æ¥æºæ ‡ç­¾ ["ai500"] æˆ– ["oi_top"] æˆ– ["ai500", "oi_top"]
}
```

**ç¤ºä¾‹å€¼ï¼š**
```
[
    {"symbol": "BNBUSDT", "sources": ["ai500"]},                    // AI 500é€‰å‡º
    {"symbol": "SOLUSDT", "sources": ["oi_top"]},                   // OIæŒä»“å¢é•¿ä¸­
    {"symbol": "AVAXUSDT", "sources": ["ai500", "oi_top"]},        // åŒé‡ä¿¡å·
    // ... æ›´å¤šå€™é€‰å¸ç§
]
```

---

## æ€§èƒ½è¯„ä¼°æ•°æ®

### å†å²è¡¨ç°åˆ†æ (`PerformanceAnalysis`)

```go
type PerformanceAnalysis struct {
    TotalTrades          int     // æ€»äº¤æ˜“æ•°
    WinningTrades        int     // ç›ˆåˆ©äº¤æ˜“æ•°
    LosingTrades         int     // äºæŸäº¤æ˜“æ•°
    WinRate              float64 // èƒœç‡ (%)
    
    TotalProfit          float64 // æ€»åˆ©æ¶¦ (USDT)
    TotalLoss            float64 // æ€»äºæŸ (USDT)
    NetProfit            float64 // å‡€åˆ©æ¶¦
    
    AverageWinSize       float64 // å¹³å‡ç›ˆåˆ©
    AverageLossSize      float64 // å¹³å‡äºæŸ
    ProfitFactor         float64 // åˆ©æ¶¦å› å­ (æ€»åˆ©æ¶¦/æ€»äºæŸ)
    
    MaxConsecutiveWins   int     // æœ€å¤§è¿èƒœ
    MaxConsecutiveLosses int     // æœ€å¤§è¿è´¥
    MaxDrawdown          float64 // æœ€å¤§å›æ’¤ (%)
    
    SharpeRatio          float64 // å¤æ™®æ¯”ç‡ (é£é™©è°ƒæ•´æ”¶ç›Š)
    
    LookbackCycles       int     // å›æº¯å‘¨æœŸæ•°
}
```

**ç¤ºä¾‹å€¼ï¼š**
```
{
    "total_trades": 25,
    "winning_trades": 18,
    "losing_trades": 7,
    "win_rate": 72.0,
    "total_profit": 1500.00,
    "total_loss": 300.00,
    "net_profit": 1200.00,
    "average_win_size": 83.33,
    "average_loss_size": 42.86,
    "profit_factor": 5.0,
    "max_consecutive_wins": 5,
    "max_consecutive_losses": 2,
    "max_drawdown": 8.5,
    "sharpe_ratio": 2.15,
    "lookback_cycles": 100
}
```

### åœ¨User Promptä¸­çš„ä½“ç°

```
## ğŸ“Š å¤æ™®æ¯”ç‡: 2.15
```

è¿™æ˜¯å”¯ä¸€åœ¨User Promptä¸­ç›´æ¥æ˜¾ç¤ºçš„æ€§èƒ½æŒ‡æ ‡ã€‚

---

## ç³»ç»ŸPromptè¯´æ˜

### System Promptçš„ä¸‰ä¸ªéƒ¨åˆ†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ ¸å¿ƒç­–ç•¥æ¨¡æ¿ (Strategy Template)                 â”‚
â”‚    â€¢ ä»æ–‡ä»¶åŠ è½½ï¼šprompts/{templateName}.txt         â”‚
â”‚    â€¢ åŒ…å«å®Œæ•´çš„äº¤æ˜“è§„åˆ™ã€ä¿¡å·åˆ¤æ–­ã€é£é™©ç®¡ç†ç­‰      â”‚
â”‚    â€¢ é€šå¸¸ 3000-5000 è¯                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. ç¡¬çº¦æŸè§„åˆ™ (Hard Constraints)                    â”‚
â”‚    â€¢ é£é™©å›æŠ¥æ¯” â‰¥ 1:2                              â”‚
â”‚    â€¢ æœ€å¤šæŒä»“3ä¸ªå¸ç§                                â”‚
â”‚    â€¢ å•å¸ä»“ä½èŒƒå›´ï¼ˆå±±å¯¨å¸ã€BTC/ETHï¼‰               â”‚
â”‚    â€¢ æ æ†é™åˆ¶ï¼ˆå±±å¯¨å¸ã€BTC/ETHï¼‰                   â”‚
â”‚    â€¢ ä¿è¯é‡‘ä½¿ç”¨ç‡ â‰¤ 90%                            â”‚
â”‚    â€¢ æœ€å°å¼€ä»“é‡‘é¢ â‰¥ 12 USDT                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. è¾“å‡ºæ ¼å¼è¦æ±‚ (Output Format)                    â”‚
â”‚    â€¢ XMLæ ‡ç­¾ï¼š<reasoning> å’Œ <decision>            â”‚
â”‚    â€¢ JSONæ•°ç»„æ ¼å¼                                  â”‚
â”‚    â€¢ å­—æ®µè¯´æ˜ï¼šactionã€confidenceã€leverageç­‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç³»ç»ŸPromptä¸­çš„åŠ¨æ€éƒ¨åˆ†

```go
// æ ¹æ®è´¦æˆ·å‡€å€¼åŠ¨æ€è®¡ç®—çº¦æŸ
å•å¸ä»“ä½: å±±å¯¨%.0f-%.0f U | BTC/ETH %.0f-%.0f U
                â†‘                          â†‘
        accountEquity*0.8      accountEquity*5
        åˆ° accountEquity*1.5   åˆ° accountEquity*10

æ æ†é™åˆ¶: **å±±å¯¨å¸æœ€å¤§{altcoinLeverage}xæ æ†** | **BTC/ETHæœ€å¤§{btcEthLeverage}xæ æ†**
```

---

## å®Œæ•´æ•°æ®æµç¤ºä¾‹

### ä¸€æ¬¡å®Œæ•´çš„AIå†³ç­–æµç¨‹

```
æ—¶é—´: 12:00:00

1ï¸âƒ£ æ„å»ºä¸Šä¸‹æ–‡æ•°æ®
   â”œâ”€ è·å–è´¦æˆ·ä¿¡æ¯ (Binance API)
   â”‚  â””â”€ TotalEquity: 10000 USDT
   â”œâ”€ è·å–æ‰€æœ‰æŒä»“ (Binance API)
   â”‚  â”œâ”€ BTCUSDT Long (ç›ˆåˆ©+1.5%)
   â”‚  â””â”€ ETHUSDT Short (ç›ˆåˆ©+0.8%)
   â”œâ”€ è·å–å€™é€‰å¸ç§åˆ—è¡¨
   â”‚  â”œâ”€ BNBUSDT (AI500)
   â”‚  â”œâ”€ SOLUSDT (OI_Top)
   â”‚  â””â”€ ... 20+ æ›´å¤šå€™é€‰
   â”œâ”€ åˆ†æå†å²è¡¨ç°
   â”‚  â””â”€ SharpeRatio: 2.15
   â””â”€ è®°å½•ç³»ç»ŸçŠ¶æ€
      â”œâ”€ å½“å‰æ—¶é—´: 12:00:00
      â”œâ”€ è¿è¡Œæ—¶é•¿: 240åˆ†é’Ÿ
      â””â”€ è°ƒç”¨æ¬¡æ•°: #48

2ï¸âƒ£ è·å–å¸‚åœºæ•°æ® (Binance WebSocket)
   è·å–æ‰€æœ‰éœ€è¦çš„å¸ç§çš„æœ€æ–°æ•°æ®:
   â”œâ”€ BTCUSDT (æŒä»“éœ€è¦)
   â”‚  â”œâ”€ CurrentPrice: 42300.75
   â”‚  â”œâ”€ PriceChange1h: +0.45%
   â”‚  â”œâ”€ PriceChange4h: +1.23%
   â”‚  â”œâ”€ CurrentEMA20: 42250.30
   â”‚  â”œâ”€ CurrentMACD: 12.50
   â”‚  â”œâ”€ CurrentRSI7: 68.5
   â”‚  â”œâ”€ OpenInterest: {Latest: 1234567, Average: 1000000}
   â”‚  â”œâ”€ FundingRate: 0.00045
   â”‚  â”œâ”€ IntradaySeries: {MidPrices: [...], EMA20Values: [...], ...}
   â”‚  â””â”€ LongerTermContext: {EMA20: 42150.30, EMA50: 41800.30, ...}
   â”œâ”€ ETHUSDT (æŒä»“éœ€è¦)
   â”‚  â””â”€ ... ç±»ä¼¼ç»“æ„
   â”œâ”€ BNBUSDT (å€™é€‰éœ€è¦)
   â”‚  â””â”€ ... ç±»ä¼¼ç»“æ„
   â”œâ”€ SOLUSDT (å€™é€‰éœ€è¦)
   â”‚  â””â”€ ... ç±»ä¼¼ç»“æ„
   â””â”€ ... å…¶ä»–20+å€™é€‰å¸ç§

3ï¸âƒ£ æ„å»º System Prompt
   â”œâ”€ åŠ è½½ prompts/default.txt
   â”‚  â””â”€ 3500è¯çš„æ ¸å¿ƒç­–ç•¥æ¨¡æ¿
   â”œâ”€ æ·»åŠ ç¡¬çº¦æŸ
   â”‚  â”œâ”€ é£é™©å›æŠ¥æ¯” â‰¥ 1:2
   â”‚  â”œâ”€ æœ€å¤šæŒä»“ 3ä¸ªå¸ç§
   â”‚  â”œâ”€ å•å¸ä»“ä½ å±±å¯¨800-1500 U | BTC/ETH 5000-10000 U
   â”‚  â”œâ”€ æ æ†é™åˆ¶: å±±å¯¨å¸æœ€å¤§3x | BTC/ETHæœ€å¤§2x
   â”‚  â”œâ”€ ä¿è¯é‡‘ä½¿ç”¨ç‡ â‰¤ 90%
   â”‚  â””â”€ æœ€å°å¼€ä»“ â‰¥ 12 USDT
   â””â”€ æ·»åŠ è¾“å‡ºæ ¼å¼è¦æ±‚
      â”œâ”€ <reasoning> æ ‡ç­¾
      â”œâ”€ <decision> æ ‡ç­¾
      â””â”€ JSONæ•°ç»„æ ¼å¼

4ï¸âƒ£ æ„å»º User Prompt
   æ—¶é—´: 12:00:00 | å‘¨æœŸ: #48 | è¿è¡Œ: 240åˆ†é’Ÿ
   
   BTC: 42300.75 (1h: +0.45%, 4h: +1.23%) | MACD: 0.0012 | RSI: 68.50
   
   è´¦æˆ·: å‡€å€¼10000.00 | ä½™é¢6000.00 (60.0%) | ç›ˆäº+5.00% | ä¿è¯é‡‘40.0% | æŒä»“2ä¸ª
   
   ## å½“å‰æŒä»“
   1. BTCUSDT LONG | å…¥åœºä»·42000.00 å½“å‰ä»·42300.00 | ç›ˆäº+1.50% | æ æ†5x | ä¿è¯é‡‘2000 | å¼ºå¹³ä»·35700.00
      current_price = 42300.7500, current_ema20 = 42250.300, ...
      [æ ¼å¼åŒ–çš„å¸‚åœºæ•°æ®...]
   
   2. ETHUSDT SHORT | å…¥åœºä»·2500.00 å½“å‰ä»·2480.00 | ç›ˆäº+0.80% | æ æ†3x | ä¿è¯é‡‘1600 | å¼ºå¹³ä»·2820.00
      current_price = 2480.0000, current_ema20 = 2470.500, ...
      [æ ¼å¼åŒ–çš„å¸‚åœºæ•°æ®...]
   
   ## å€™é€‰å¸ç§ (25ä¸ª)
   ### 1. BNBUSDT (AI500+OI_TopåŒé‡ä¿¡å·)
      current_price = 640.2500, current_ema20 = 635.300, ...
      [æ ¼å¼åŒ–çš„å¸‚åœºæ•°æ®...]
   
   ### 2. SOLUSDT (OI_TopæŒä»“å¢é•¿)
      current_price = 185.5000, current_ema20 = 182.500, ...
      [æ ¼å¼åŒ–çš„å¸‚åœºæ•°æ®...]
   
   ... æ›´å¤šå€™é€‰å¸ç§ ...
   
   ## ğŸ“Š å¤æ™®æ¯”ç‡: 2.15
   
   ---
   
   ç°åœ¨è¯·åˆ†æå¹¶è¾“å‡ºå†³ç­–ï¼ˆæ€ç»´é“¾ + JSONï¼‰

5ï¸âƒ£ è°ƒç”¨ AI API (DeepSeek/Qwen/OpenAI)
   POST /v1/chat/completions
   {
       "messages": [
           {
               "role": "system",
               "content": "[System Prompt - 3500+ words]"
           },
           {
               "role": "user", 
               "content": "[User Prompt - åŠ¨æ€å†…å®¹]"
           }
       ]
   }

6ï¸âƒ£ AI è¿”å›å®Œæ•´å“åº”
   <reasoning>
   åˆ†æBTCï¼š
   - 1å°æ—¶æ¶¨å¹…0.45%ï¼Œ4å°æ—¶æ¶¨å¹…1.23%ï¼Œè¡¨ç°æŒç»­å‘ä¸Š
   - MACDå€¼ä¸º12.50ï¼Œå¤„äºé«˜ä½ï¼Œä½†è¿˜æœªå½¢æˆæ­»å‰
   - RSI7ä¸º68.5ï¼Œæ¥è¿‘è¶…ä¹°åŒºåŸŸï¼ˆ70ï¼‰ï¼Œéœ€è¦å°å¿ƒå›è°ƒ
   - å½“å‰æŒä»“ç›ˆåˆ©1.5%ï¼Œå¯ä»¥è€ƒè™‘éƒ¨åˆ†æ­¢ç›ˆ
   
   åˆ†æå€™é€‰å¸ç§BNBUSDTï¼š
   - åŒé‡ä¿¡å·ï¼ˆAI500 + OI_Topï¼‰ï¼Œè¯´æ˜æœºæ„ä¹Ÿåœ¨å…³æ³¨
   - ä»·æ ¼å¤„äºä¸Šå‡è¶‹åŠ¿ï¼Œå¯ä»¥è€ƒè™‘è¿½é«˜
   
   è€ƒè™‘é£é™©ï¼š
   - ç›®å‰å·²ç”¨ä¿è¯é‡‘40%ï¼Œè¿˜æœ‰60%çš„ç©ºé—´
   - RSI7å³å°†è¿›å…¥è¶…ä¹°ï¼Œéœ€è¦è°¨æ…
   - å»ºè®®éƒ¨åˆ†æ­¢ç›ˆï¼ŒåŒæ—¶ç²¾é€‰é«˜è´¨é‡çš„æ–°æœºä¼š
   </reasoning>
   
   <decision>
   ```json
   [
       {
           "symbol": "BTCUSDT",
           "action": "partial_close",
           "close_percentage": 30,
           "confidence": 80,
           "reasoning": "æ­¢ç›ˆä¸€éƒ¨åˆ†ï¼Œé”å®šæ”¶ç›Š"
       },
       {
           "symbol": "BNBUSDT",
           "action": "open_long",
           "leverage": 3,
           "position_size_usd": 900,
           "stop_loss": 625.00,
           "take_profit": 670.00,
           "confidence": 75,
           "risk_usd": 200,
           "reasoning": "åŒé‡ä¿¡å·ï¼Œä¸Šå‡è¶‹åŠ¿ç¡®è®¤"
       },
       {
           "symbol": "ETHUSDT",
           "action": "hold",
           "reasoning": "ä¿æŒç©ºä»“æŒæœ‰"
       },
       {
           "symbol": "SOLUSDT",
           "action": "wait",
           "reasoning": "æš‚æ—¶è§‚å¯Ÿï¼Œç­‰å¾…æ›´å¥½çš„è¿›åœºç‚¹"
       }
   ]
   ```
   </decision>

7ï¸âƒ£ è§£æ AI å“åº”
   â”œâ”€ æå–æ€ç»´é“¾ (CoT Trace)
   â”‚  â””â”€ "[reasoning] å†…å®¹æå–"
   â”œâ”€ æå– JSON å†³ç­–
   â”‚  â”œâ”€ è§£æ [...]
   â”‚  â”œâ”€ éªŒè¯æ ¼å¼
   â”‚  â””â”€ è¿”å› Decision å¯¹è±¡æ•°ç»„
   â””â”€ éªŒè¯å†³ç­–åˆæ³•æ€§
      â”œâ”€ æ£€æŸ¥æ æ†é™åˆ¶
      â”œâ”€ æ£€æŸ¥ä¿è¯é‡‘ä½¿ç”¨
      â”œâ”€ æ£€æŸ¥é£é™©å›æŠ¥æ¯”
      â””â”€ æ£€æŸ¥å•å¸ä»“ä½èŒƒå›´

8ï¸âƒ£ è¿”å› FullDecision
   {
       "system_prompt": "[å®Œæ•´System Prompt]",
       "user_prompt": "[å®Œæ•´User Prompt]",
       "cot_trace": "[æ€ç»´é“¾å†…å®¹]",
       "decisions": [
           {"symbol": "BTCUSDT", "action": "partial_close", ...},
           {"symbol": "BNBUSDT", "action": "open_long", ...},
           ...
       ],
       "timestamp": "2024-11-15T12:00:00Z"
   }
```

---

