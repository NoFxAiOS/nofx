# 📱 手机端动态控制归档功能 - 快速开始

## 🎯 一句话说明

**在手机 Telegram 上归档/取消归档频道，程序自动同步，无需重启！**

---

## ⚡ 3 步开始使用

### 第 1 步：修改配置

编辑 `.env` 文件，修改以下 3 行：

```bash
LISTEN_ALL_SUBSCRIBED_CHANNELS=true    # 改为 true
LISTEN_ARCHIVED_ONLY=true              # 改为 true
ARCHIVED_REFRESH_INTERVAL=300          # 已添加，保持默认
```

### 第 2 步：启动程序

```bash
./start.sh
```

看到这个提示说明成功：
```
📱 手机端归档/取消归档频道会自动生效，无需重启程序
```

### 第 3 步：在手机上管理频道

#### 📂 想监听某个频道？
→ 在 Telegram 中**归档**它

#### 📋 不想监听了？
→ 在 Telegram 中**取消归档**

**最多等 5 分钟生效！**

---

## 📊 工作原理

```
手机端归档频道
      ↓
   (最多 5 分钟)
      ↓
程序自动检测
      ↓
开始/停止监听
```

---

## 💡 实际案例

### 案例 1：临时屏蔽低质量频道

**问题**：某频道最近发很多广告，暂时不想监听

**解决**：
1. 手机上取消归档该频道
2. 等待 5 分钟
3. ✅ 程序自动停止监听，广告不再入库

### 案例 2：动态添加新频道

**场景**：发现一个优质新频道

**操作**：
1. 手机上归档该频道
2. 等待 5 分钟
3. ✅ 程序自动开始监听，消息入库

---

## 🔍 查看变化日志

程序会自动记录归档变化：

```bash
# 实时查看
tail -f logs/jt_bot.log | grep "归档"
```

**示例输出**：

```
📂 检测到新归档频道 (1 个):
  ➕ 彭博社 (@bloomberg)

📋 检测到取消归档频道 (1 个):
  ➖ 路透社 (@reuters)
```

---

## ⚙️ 配置调整（可选）

### 调整刷新速度

```bash
# 更快响应（1 分钟检测一次）
ARCHIVED_REFRESH_INTERVAL=60

# 默认（5 分钟检测一次）⭐ 推荐
ARCHIVED_REFRESH_INTERVAL=300

# 更省资源（10 分钟检测一次）
ARCHIVED_REFRESH_INTERVAL=600
```

---

## ❓ 常见问题

### Q: 归档后多久生效？
**A**: 最多等待 `ARCHIVED_REFRESH_INTERVAL` 秒（默认 5 分钟）

### Q: 可以立即生效吗？
**A**: 重启程序可以立即刷新：
```bash
./start.sh stop && ./start.sh
```

### Q: 如何确认归档模式已开启？
**A**: 启动时看到这个提示即可：
```
📱 手机端归档/取消归档频道会自动生效，无需重启程序
```

### Q: 影响性能吗？
**A**: 不影响。每 5 分钟仅查询一次归档列表，非常轻量。

---

## 📖 完整文档

- **详细说明**: 查看 `动态归档功能说明.md`
- **技术文档**: 查看 `ARCHIVED_CHANNELS_FEATURE.md`

---

## ✨ 核心优势

| 传统方式 | 动态归档方式 |
|---------|-----------|
| 修改配置文件 | 手机端归档/取消归档 |
| 重启程序生效 | 自动生效（最多 5 分钟） |
| 管理不直观 | 可视化管理（归档文件夹） |
| 需要记住频道 ID | 直接操作频道 |

---

## 🎉 开始使用

```bash
# 1. 修改配置
vim .env
# 设置:
#   LISTEN_ALL_SUBSCRIBED_CHANNELS=true
#   LISTEN_ARCHIVED_ONLY=true

# 2. 启动程序
./start.sh

# 3. 在手机上管理归档
# 完成！
```

**现在你可以用手机实时控制监听范围了！** 📱✨
