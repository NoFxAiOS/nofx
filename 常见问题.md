# 常见问题

## 币安持仓模式错误 (code=-4061)

**错误信息**：`Order's position side does not match user's setting`

**原因**：系统需要使用双向持仓模式，但您的币安账户设置为单向持仓。

### 解决方法

1. 登录 [币安合约交易平台](https://www.binance.com/zh-CN/futures/BTCUSDT)

2. 点击右上角的 **⚙️ 偏好设置**

3. 选择 **持仓模式**

4. 切换为 **双向持仓** (Hedge Mode)

5. 确认切换

**注意**：切换前必须先平掉所有持仓。

---

## 如何获取币安 API 密钥

1. 登录币安账户，进入 [API 管理页面](https://www.binance.com/zh-CN/support/faq/detail/6b9a63f1e3384cf48a2eedb82767a69a)

2. 点击"创建 API"

3. 设置 API 密钥标签（例如：nofx）

4. 选择 API 权限，确保勾选了"合约"权限

5. 完成安全验证

6. 保存 API Key 和 Secret Key，系统仅在此时显示 Secret Key

**注意**：为了安全，请为 API 密钥设置 IP 白名单限制

---

## 如何将多行 PEM 格式转换为单行

当使用 Ed25519 或 RSA 类型 API 密钥时，您可能需要将多行 PEM 格式私钥转换为单行格式：

### 方法一：使用命令行（Linux/Mac）

```bash
# 将PEM文件中的换行符替换为\n字符
awk 'NR==1{printf "%s\\n", $0} NR>1{printf "\\n%s\\n", $0}' your_key.pem
```

### 方法二：使用 Python 脚本

```python
with open('your_key.pem', 'r') as f:
    content = f.read().replace('\n', '\\n')
    print(content)
```

### 配置示例

转换后的内容在配置文件中应如下所示：

```json
{
  "traders": [
    {
      "id": "my_trader",
      "name": "My AI Trader",
      "ai_model": "deepseek",
      "exchange": "binance",
      "binance_api_key": "YOUR_BINANCE_API_KEY",
      "binance_secret_key": "-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQ...\\n-----END PRIVATE KEY-----\\n",
      "binance_api_key_type": "Ed25519",
      "deepseek_key": "sk-xxxxxxxxxxxxx",
      "initial_balance": 1000.0,
      "scan_interval_minutes": 3
    }
  ]
}
```

更多问题请查看 [GitHub Issues](https://github.com/tinkle-community/nofx/issues)
